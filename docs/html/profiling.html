<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>AXIS Embedded Development SDK: Profiling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.axis.com"><img alt="Logo" src="axis_logo.png" width="200"/></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">AXIS Embedded Development SDK  
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="files.html"><span>API&#160;Specification</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('profiling.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Profiling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="about"></a>
About axis_profile</h1>
<p><code>axis_profile</code> is a open source project started by Axis to allow SDK developers to profile their applications. The project is located at <a href="https://savannah.nongnu.org/projects/axis-profile" target="_blank">https://savannah.nongnu.org/projects/axis-profile</a></p>
<h1><a class="anchor" id="pr_comp"></a>
Compilation</h1>
<p>To build the Axis profiler, start by downloading the open source project. To download the source code, <code>git</code> or <code>cvs</code> must be installed on the host system. When the source code is downloaded, build the <code>axis_profile</code> application. </p><pre class="fragment">user@host$ . init_env
user@host$ cd apps
user@host$ git clone git://git.savannah.nongnu.org/axis-profile.git
user@host$ cd axis-profile
user@host$ make</pre><p>The host application <code>axis_profile</code> is now created. Use the help option to view available options: </p><pre class="fragment">user@host$ axis_profile -h
axis_profile version 3.0
Usage: axis_profile [options] hostname
Options:
-v num    set verbose level (0-3, default 0)
-c num    set number of functions to print (default 20)
-s ival   set sample interval (default 5s)
-p pid    pid to trace (default all)
-a name   application to trace (default all)
-b num    use restricted "ps": 0 = no (default), 1 = yes
-d prog   do symbol dump using readelf (default), nm or objcopy
-h        print this help text</pre><p>To see all the application functions with <code>axis_profile</code>, debugging must be enabled when compiling the appliction. Run <code>make debug</code>. Do not strip the binary before uploading it to the Axis product. Avoid using static functions as they may be linlined by the compiler and therefore not shown in the profiling results.</p>
<h1><a class="anchor" id="pr_example"></a>
Example</h1>
<p>In this section, <code>axis_profile</code> is used on the example application <code>apps/analyze</code>. Start by removing optimization and stripping in the <code>Makefile:</code> </p><pre class="fragment">user@host$ cd apps/analyze
user@host$ gedit Makefile
...
CFLAGS   += -Wall # -g -O2                          &lt;&lt; here comment out -g -O2
...
$(PROGS): $(OBJS) $(MYLIB)
    $(CC) $(LDFLAGS) $^ $(LIBS) $(LDLIBS) -o $@
    #$(STRIP) $@                                &lt;&lt; here comment out stripping</pre><p>Compile in debug mode, install and start: </p><pre class="fragment">user@host$ make debug
user@host$ create-package.sh&amp;&amp;eap-install.sh &lt;camera_ip&gt; &lt;your_password&gt; install&amp;&amp;install-onto-target.sh start</pre><p>After installing the appliation in the Axis product, start the application from the web pages (page Application &gt; Overview) and open the log to find the application's Process ID (pid). The pid is needed to trace only one particular process. In the example below the pid is <b>1996</b>. The pid changes each time the application is restarted. </p><pre class="fragment">&lt;INFO    &gt; Apr 19 13:01:09 axis-00408c93d042 analyze[1996]: Starting!</pre><p>Start <code>axis_profile</code> using the pid. The environment variable <code>AXIS_KERNEL_DIR</code> must be set to a dummy value for <code>axis_profile</code> to run. </p><pre class="fragment">user@host$ AXIS_KERNEL_DIR=. ../axis-profile/axis_profile &lt;camera_ip&gt; -p 1996</pre><p>Example of the output produced by the tool: </p><pre class="fragment">Collecting samples. Press CTRL-C to stop and print statistics.
Total sample time: 61.59 seconds

Application kernel (pid 0) 80% (49.41 seconds)
    48.85s  98.87%  &lt;unknown&gt;                  kernel
     0.56s   1.13%  &lt;unknown&gt;                  artpec_3
---------- -------
    49.41s 100.00%

Application /usr/local/packages/analyze/analyze (pid 8641) 0% (0.22 seconds)
     0.21s  95.45%  analyze_algorithm
     0.01s   4.55%  free                       /lib/libuClibc-0.9.29.so
---------- -------
     0.22s 100.00%

Lost 0 kernel samples and 1196 user mode samples</pre><p> <p class="previous"> <a href="debugging.html"><< Debugging</a> <p>
<p class="next"> <a href="example_apps.html">Example Applications >></a> <p>  </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li id="footer1">Copyright &copy; 2009-2015 Axis Communications AB. All rights reserved.  
	 </li>	 
	<li id="footer2">		     
	AXIS Embedded Development SDK version 2.0.2. Created: Fri Jul 17 2015.</li>     	
  </ul>
</div>
</body>
</html>
