<!-- HTML header for doxygen 1.8.4-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>AXIS Embedded Development SDK: Creating an Application Package</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.axis.com"><img alt="Logo" src="axis_logo.png" width="200"/></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">AXIS Embedded Development SDK  
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="files.html"><span>API&#160;Specification</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('application_package.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Creating an Application Package </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page describes the elements composing an application package and how to put them together in a ready-to-use package file (.eap).</p><ul>
<li><a class="el" href="application_package.html#package_introduction">About application packages</a></li>
<li><a class="el" href="application_package.html#package_contents">Contents of an application package</a></li>
<li>The <a class="el" href="application_package.html#pack_conf">package.conf</a> file</li>
<li>The <a class="el" href="application_package.html#param_format">param.conf</a> file</li>
<li><a class="el" href="application_package.html#save_data">Saving arbitrary data</a></li>
<li><a class="el" href="application_package.html#web">Web related content</a> <br />
 </li>
</ul>
<h1><a class="anchor" id="package_introduction"></a>
About application packages</h1>
<p>An application package contains the application and all associated files in a single <code>eap</code> file. The <code>eap</code> file can be stored on a web server to be distributed by other means.</p>
<p>The application package is created and installed on the Axis product in several steps:</p><ul>
<li>The application is compiled and linked, and the binary and all required files are packed into a package (using <code>create-package.sh</code>).</li>
<li>The package is uploaded to the Axis product (using the script <code>eap-install.sh</code>, using a web browser or using VAPIX&reg;).</li>
<li>The Axis product checks the uploaded package and starts the installer (integrated in the package).</li>
<li>The installer installs all files and directories.</li>
<li>The installer creates a startup script, if configured.</li>
<li>After installation, a customer install script may be executed.</li>
</ul>
<h1><a class="anchor" id="package_contents"></a>
Contents of an application package</h1>
<p>An application package contains the following files and directories:</p>
<ul>
<li><code>package.conf</code> This file defines the files included in the package. The file is mandatory and is described in the <a class="el" href="application_package.html#pack_conf">package.conf</a> section.</li>
<li><code>param.conf</code> This file defines the parameter configuration. The file is mandatory and is described in the <a class="el" href="application_package.html#param_format">param.conf</a> section.</li>
<li><code>html/</code> This directory will be copied as a whole and all of its contents will be reachable directly from a web browser. See section <a class="el" href="application_package.html#html">The html directory</a>.</li>
<li>The files that are defined in the following configuration variables: <code>APPNAME</code>, <code>OTHERFILES</code> and <code>POSTINSTALLSCRIPT</code>. The configuration variables are set in <code>package.conf</code>.</li>
</ul>
<h1><a class="anchor" id="pack_conf"></a>
package.conf</h1>
<p>The file <code>package.conf</code> file is included in the application package and contains variables describing the application. The script <code>create-package.sh</code> reads the contents of <code>package.conf</code> when the application package is created.<br />
 Below is a description of the file content.</p>
<p><code>PACKAGENAME</code> is a user friendly package name. The name will be displayed in the Axis product's web pages.<br />
 <code>MENUNAME</code> is the name that will be displayed in the web pages' left-hand side menu.<br />
 <code>APPNAME</code> is application's executable name.<br />
</p><pre class="fragment">PACKAGENAME="Analyze example"
MENUNAME="Analyze"
APPNAME="analyze"</pre><p><code>APPID</code> is the application ID. The application ID is provided by Axis and is needed when using license keys. To request an application ID, contact the ADP Helpdesk. Can be left empty.<br />
</p><pre class="fragment">APPID="123"
APPID=""</pre><p><code>VENDOR</code> is the name of the vendor that created the application. </p><pre class="fragment">VENDOR="Company name"</pre><p><code>APPOPTS</code> contains the application command line options. May be empty. </p><pre class="fragment">APPOPTS="-o option"
APPOPTS=""</pre><p><code>APPMAJORVERSION</code> is the application's major version, a numerical value.<br />
 <code>APPMINORVERSION</code> is the application's minor version, a numerical value.<br />
 <code>APPMICROVERSION</code> (optional) is the application's micro version, this is interpreted as a string. </p><pre class="fragment">APPMAJORVERSION="2"
APPMINORVERSION="0"
APPMICROVERSION="rc1"</pre><p><code>OTHERFILES</code> is a space-separated list of other files and/or directories to be included in the package. Files listed here will be copied to the application directory during installation. <code>OTHERFILES</code> can be used if separate libraries or configuration files are used by the main program. Leave empty if not required. </p><pre class="fragment">OTHERFILES=""</pre><p><code>LICENSEPAGE</code> specifies if a license page should be displayed in Axis product's the web pages. Possible values are:</p>
<ul>
<li><b>axis</b> The Axis license page will be displayed.</li>
<li><b>custom</b> A custom license page defined by file <code>html/license.inc</code> will be displayed.</li>
<li><b>none</b> No license page will be displayed.</li>
</ul>
<p>The information in the "License installed" field in the Setup &gt; Applications &gt; Overview page in the Axis product's web pages differs depending on the value of <code>LICENSEPAGE</code>.</p>
<p> 
    <table class="bordered" style="text-align:center">
    <tr><td><tt>LICENSEPAGE</tt></td><td> &nbsp; &nbsp;&nbsp;  Axis license &nbsp; </td>       <td> &nbsp;  no Axis license &nbsp;  </td>  <td> &nbsp;  license.inc  &nbsp; </td>       <td> &nbsp;  no license.inc &nbsp;  </td></tr>
    <tr><td><tt>axis</tt></td><td style="color:blue">yes</td> <td style="color:blue">no</td> <td><i>N/A</i></td> <td><i>N/A</i></td></tr>
    <tr><td><tt>none</tt></td> <td style="color:blue">-</td> <td style="color:blue">-</td>                <td style="color:blue">-</td> <td style="color:blue">-</td></tr>
    <tr><td><tt>custom</tt></td> <td><i>N/A</i></td>  <td><i>N/A</i></td><td style="color:blue">yes</td> <td style="color:blue">-</td></tr>
    </table>
    <br>
    </p>
<pre class="fragment">LICENSEPAGE="axis"</pre><p><code>LICENSE_CHECK_ARGS</code> (optional) Used together with <code>LICENSEPAGE="custom"</code> to enable display of the status of a custom license in the web user interface. see licensekey.c </p><pre class="fragment">LICENSEPAGE="custom"
LICENSE_CHECK_ARGS="--license"</pre><p><code>SETTINGSPAGEFILE</code> (optional) specifies the file to use for a custom Settings page. The file (<code>settings.html</code> in this example) must be located in the <code>html/</code> directory. If <code>SETTINGSPAGEFILE</code> is specified, a link from from <b>Applications &gt; [application name] &gt; Settings page </b> will direct users to the custom Settings page. A settings page can for example be used to configure and control the application.<br />
 <code>SETTINGSPAGETEXT</code> (optional) is the text displayed on the link to the custom Settings page defined by <code>SETTINGSPAGEFILE</code>.<br />
</p><pre class="fragment">SETTINGSPAGEFILE="settings.html"
SETTINGSPAGETEXT="Window settings"</pre><p><code>VENDORHOMEPAGELINK</code> (optional) specifies a link to the vendor's homepage. For an example, see <a class="el" href="index.html#web_subsec">Web pages overview</a> on the Main page. </p><pre class="fragment">VENDORHOMEPAGELINK="&lt;a href='http://www.vendor.com'&gt;Vendor&lt;/a&gt;"</pre><p><code>HTTPCGIPATHS</code> (optional) filename reference to a file containing a list of CGI's that an http-enabled application will use. See example application <a class="el" href="ax_http_serve_request_8c-example.html">ax_http_serve_request.c</a> for more information. </p><pre class="fragment">HTTPCGIPATHS="cgi_paths.txt"</pre><p><code>POSTINSTALLSCRIPT</code> (optional) is a script that will be executed on the Axis product when the installation is completed. The script must be a shell script located in the same directory as the <code>package.conf</code> file. The script will be executed from the application directory in the Axis product. </p><pre class="fragment">POSTINSTALLSCRIPT="setup.sh"
POSTINSTALLSCRIPT=""</pre><p><code>REQEMBDEVVERSION</code> specifies the minimum required SDK version that the product running the application must support. Firmware version 5.60 correspond to <code>REQEMBDEVVERSION="2.0"</code> </p><pre class="fragment">REQEMBDEVVERSION="2.0"</pre><p><code>APPUSR</code> and <code>APPGRP</code> is the user/group the application will run as. The recommended user and group is "sdk" </p><pre class="fragment">APPUSR="sdk"
APPGRP="sdk"</pre><p><code>STARTMODE</code> defines how the application is started. Possible values are:</p><ul>
<li><b>respawn</b> Application is started automatically when the system starts (on boot). If the application would crash, it is restarted automatically (using Axis respawn daemon).</li>
<li><b>once</b> Application is started automatically when the system starts. It is not restarted after a crash.</li>
<li><b>never</b> Application should not be started automatically.</li>
</ul>
<pre class="fragment">STARTMODE="respawn"</pre><p>The application package generated by <code>create-package.sh</code> will be named: "APPNAME_APPMAJORVERSION_APPMINORVERSION-APPMICROVERSION_PROCESSORTYPE.eap".<br />
 For example, <code>analyze_1_1-rc1_armv6.eap</code> using the file in the example above. <code>PROCESSORTYPE</code> is added automatically by <code>create-package.sh</code>. If required, the package can be renamed before being uploaded to the Axis product.<br />
 <br />
 <br />
 </p>
<h1><a class="anchor" id="param_format"></a>
param.conf</h1>
<p>The file <code>param.conf</code> defines the application's parameter configuration. For each entry in the file, a parameter will be created when the application is installed in the Axis product. Using the <a class="el" href="ax__parameter_8h.html">Parameter interface</a>, parameters can also be created at runtime.</p>
<p>All parameters are created as standard Axis parameters (VAPIX&reg; parameters) and are therefore visible in the product and can be accessed for example from the Plain Config page. Parameters created by applications can only be modified by users with administrator access rights.</p>
<p>Each entry in <code>param.conf</code> should have the following format: </p><pre class="fragment">ParameterName = "ParameterValue" type = "parametertype"</pre><p>If <code>type</code> is not specified, <code>string</code> is assumed. Below are some examples of parameters: </p><pre class="fragment">Param1 = "Singleword" type = "string:maxlen=10" String with maximum length 10
Param2 = "Multiple-word value"                  No specified type; type string will be used
Param3 = "10" type = "int:min=0;max=100"        Integer with minimum and maximum values
Param4 = "" type = "string"                     Empty string</pre><h2><a class="anchor" id="param_types"></a>
Parameter types to use for HTML forms</h2>
<p>The parameter types listed below can be used for parameters that should be modified from a web page (Settings page) in the Axis product. In <code>param.conf</code>, the parameter can be defined as radio button, drop-down list, input field etc.</p>
<p>Radio buttons: </p><pre class="fragment">type = "radio:TCPIP|Generic TCP/IP, HTTP|Generic HTTP, OFF|OFF"</pre><p>Drop-down list (SELECT tag): </p><pre class="fragment">type = "enum:TCPIP|Generic TCP/IP, HTTP|Generic HTTP, OFF|OFF"
type = "enum:38400, 57600, 115200, 230400|230400 (experimental)"</pre><p>Checkbox (or drop-down list depending on configuration). The first value is the unchecked value. If the first value is <code>YES</code>, <code>ON</code>, <code>TRUE</code>, <code>ENABLE*</code> or <code>1</code>, then reverse order is assumed: </p><pre class="fragment">type = "bool:no,yes"</pre><p>Short forms:<br />
 <code>type="yes_no"</code> can be used instead of <code>type="bool:yes,no"</code>. <code>type="on_off"</code> can be used instead of <code>type="bool:on,off"</code>.</p>
<p>Checkbox (only for boolean values). The first value is the unchecked value. If the first value is <code>YES</code>, <code>ON</code>, <code>TRUE</code>, <code>ENABLE*</code> or <code>1</code>, then reverse order is assumed: </p><pre class="fragment">type = "checkbox:NO,YES"</pre><p>Plain input field (for <code>string</code> values): </p><pre class="fragment">type = "string[:maxlen=X]"</pre><p>Plain input field (for <code>int</code> values). After the input field, <code>[min..max]</code>, <code>[..max]</code>, <code>[min..]</code> or <code>[0, 1024..65535]</code> will be displayed. If <code>maxlen</code> is not specified, it will be calculated based on the longest number in the allowed range. The size of the input field will be <code>maxlen</code> <code>+</code> <code>2</code> or more in steps of 5: </p><pre class="fragment">type = "int[:[maxlen=X;][min=Y;][max=Z]]"
type = "int[:[maxlen=X;]range=0,1024-65535]"</pre><p>Text area: </p><pre class="fragment">type = "textarea"</pre><p>Plain input field with maximum length 17. Should be used for MAC addresses, for example 00:40:8C:01:34:67. </p><pre class="fragment">type = "MACADDR"</pre><p>Plain input field with maximum length 15. Should be used for IP addresses (numeric value only), for example 123.167.101.145. </p><pre class="fragment">type = "IP" or type = "ip"</pre><p>Plain input field with maximum length 64. Should be used for IP addresses (numeric value) or host names: </p><pre class="fragment">type = "IPNAME"</pre><p>Password input field. The typed characters will be masked by '*' characters: </p><pre class="fragment">type = "password[:maxlen=X]"</pre><p>Hidden field. The field will be sent to the web browser but will not be displayed: </p><pre class="fragment">type = "hidden"</pre><p><br />
</p>
<h1><a class="anchor" id="save_data"></a>
Saving arbitrary data</h1>
<p>In the Axis product, the application is installed in the <code>/usr/local/packages/APPNAME/</code> directory. Arbitrary data such as configuration data and images should be saved in the subdirectory <code>localdata</code>. The <code>localdata</code> directory is owned by <code>APPUSR</code> and the application has write access.<br />
 Avoid continuous writes to localdata as localdata resides on a flash drive with limited write count per block. Internal wear leveling minimizes the risk of failure, however, it is still strongly recommended to avoid continuous writes.<br />
 The available free space is product-dependent. The free space is either 8 MB or 32 MB minus the size of installed applications. Use Storage API if a larger amount of free space is required. <br />
<br />
 </p>
<h1><a class="anchor" id="web"></a>
Web related content</h1>
<h2><a class="anchor" id="html"></a>
The html directory</h2>
<p>The subdirectory <code>html/</code> in the appliction's root directory should contain files required for the application's web pages. When creating an application package, the script <code>create-package.sh</code> will include the contents of <code>html/</code>. When the application has been installed in the Axis product, the web pages are available from <a href="http://camera_ip/local/APPNAME" target="_blank">http://camera_ip/local/APPNAME</a> and from the Setup &gt; Applications page.</p>
<p>An application can have web pages such as a Main page, a custom settings page and an About page.</p>
<p>The Main page is created if <code>html/</code> contains a file <code>index.html</code>. A link named <em>Main</em> <em>page</em> will be created in the application's menu. Clicking the link will open <code>index.html</code> in a new window. From <code>index.html</code>, it is possible to link to other custom pages located in the <code>html/</code> directory.</p>
<p>From the default Settings page, a link to a custom settings page can be created using <code>SETTINGSPAGEFILE</code> and <code>SETTINGSPAGETEXT</code> in <code>package.conf</code>. The custom settings page will open in a new window. <code>SETTINGSPAGEFILE</code> should be the name of the custom settings page located in <code>html/</code> and <code>SETTINGSPAGETEXT</code> should be the text to be displayed as the link.</p>
<p>The About page is created if <code>html/</code> contains a file <code>about.inc</code>. Add the text to be displayed, for example a description of the application or company, trademark acknowlegments and copyright information, to <code>about.inc</code>. The file may contain HTML formatting; the contents will be inserted into the predefined About page.</p>
<p>For examples, see <a class="el" href="ax_http_serve_request_8c-example.html">ax_http_serve_request.c</a></p>
<h2><a class="anchor" id="httpd_format"></a>
Register CGI path(s)</h2>
<p>For the application to be able to use the HTTP interface to handle incoming requests, a configuration file is required. The configuration file should list all paths used by the application, together with the required access level for the CGI.</p>
<p><b>syntax:</b> </p><pre class="fragment">&lt;access_level&gt; &lt;path&gt;
&lt;access_level&gt; &lt;path&gt;
&lt;...&gt;</pre><p>where the access_level must be one of</p><ul>
<li>viewer</li>
<li>operator</li>
<li>administrator</li>
</ul>
<p><b>Example:</b> </p><pre class="fragment">viewer /detectors/list.cgi
operator /detectors/add.cgi
administrator /detectors/remove.cgi</pre><p>The configuration file must reside in the same directory as the package.conf file. The filename can be chosen freely, as long as it matches the name specified in the <a class="el" href="application_package.html#pack_conf">package.conf</a> variable <b>HTTPCGIPATHS</b>.</p>
<p><b>Example:</b> </p><pre class="fragment">user@host$ grep 'HTTPCGIPATHS' package.conf
HTTPCGIPATHS="cgi_paths.txt"

user@host$ cat cgi_paths.txt
viewer /detectors/list.cgi
operator /detectors/add.cgi
administrator /detectors/remove.cgi</pre><p> <p class="previous"> <a href="compilation.html"><< Compiling and Running an Application</a> <p>
<p class="next"> <a href="debugging.html">Debugging >></a> <p>  </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.4-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li id="footer1">Copyright &copy; 2009-2015 Axis Communications AB. All rights reserved.  
	 </li>	 
	<li id="footer2">		     
	AXIS Embedded Development SDK version 2.0.2. Created: Fri Jul 17 2015.</li>     	
  </ul>
</div>
</body>
</html>
